---
title: "Inferência estatística"
subtitle: "Aula 5"
author: "Bruno Montezano"
institute: "Grupo Alliance<br>Programa de Pós-Graduação em Psiquiatria e Ciências do Comportamento<br>Universidade Federal do Rio Grande do Sul"
date: last-modified
date-format: long
lang: pt-br
execute:
  echo: true
format:
  revealjs:
    incremental: true
    smaller: true
    theme: [default, ../assets/custom.scss]
    logo: "../assets/logo_ufrgs.png"
bibliography: references.bib
---

## Conteúdo de hoje

- Introdução
- População e amostra
- Testes de hipótese
  - Hipótese nula e alternativa
  - Tipos de erro
  - Interpretação de resultados

## O que é estatística inferencial?

* Um dos principais objetivos ao fazer pesquisa é *generalizar as descobertas* para
toda a população
  - Amostra $\rightarrow$ População
  
* Um **modelo estatístico** é uma *representação* de um fenômeno complexo que gerou
os dados
  - Por vezes, assume pressupostos sobre as variáveis

* Quando pesquisamos, estamos interessados em testar hipóteses
  - Suposição sobre o estado das coisas
  - Podem ser substantivas (formulação textual ou semântica)
  ou estatísticas (operacionalização da hipótese substantiva)

## Hipóteses estatísticas

* Hipótese nula ($H_0$): a mais conservadora, advoga pela ausência de padrões ou associações, em geral o pesquisador não acredita

* Hipótese alternativa ($H_a$): apoia relação ou diferença entre as variáveis,
comumente a hipótese que motivou o pesquisador a coletar seus dados

* Em estatística frequentista, os testes testarão a adequação dos dados à
hipótese nula

. . .

$$\underbrace{O \,grupo \,que \,tomou \,antidepressivo \,apresenta \,menos \,sintomas \,depressivos}_\text{Hipótese  substantiva}$$

$$H_0: \mu_{tomou} = \mu_{não \,tomou}$$
$$\underbrace{H_a: \mu_{tomou} < \mu_{não \,tomou}}_\text{Hipóteses estatísticas}$$

## Vamos ver alguns testes estatísticos!

![](../assets/meme_hipotese.jpg){fig-align="center" width=75%}

## Teste qui-quadrado de independência

* Usado para verificar se duas variáveis categóricas são independentes 

* Pressupostos:
  - Os dados são aleatórios e representativos da população
  - As variáveis analisadas são categóricas

* Algumas hipóteses de pesquisa a serem respondidas pelo teste $\chi^2$:
  - Verificar se sexo e escolha do curso de graduação são independentes
  - Testar se classe social e reprovação na escola são independentes
  - Avaliar se obesidade e morte por COVID-19 são independentes
  
## Exemplo de teste $\chi^2$ no R

::: columns
::: {.column width="50%"}
```{r qui-quadrado-especie-ilha}
library(dados)
library(janitor)

# Criar uma tabulação cruzada
# entre espécie e ilha
pinguins |> 
  tabyl(especie, ilha)

# Rodar um teste qui-quadrado de independência
chisq.test(pinguins$especie, pinguins$ilha)
```
:::

::: {.column width="50%"}
```{r grafico-ilha-especie}
library(ggplot2)

ggplot(pinguins,
       aes(x = especie, fill = ilha)) +
  geom_bar(position = "fill") +
  labs(x = "Espécie",
       y = "Proporção",
       fill = "Ilha") +
  ghibli::scale_fill_ghibli_d("PonyoMedium") +
  scale_y_continuous(labels = scales::percent) +
  theme_minimal(base_size = 21,
                base_family = "Charter")
```

:::
:::

## $V$ de Cramer

* Os $p$-valores quase nunca são informativos sobre a relevância dos resultados

* O **tamanho do efeito** é uma medida objetiva e padronizada sobre um efeito
observado

* O tamanho do efeito mais utilizado no teste $\chi^2$ é
o $V$ de Cramer
  - Esta estatística gera valores entre 0 e 1
  - A interpretação se baseia nos graus de liberdade

. . .

::: columns
::: {.column width="50%"}
| Graus de liberdade | Pequeno | Médio | Grande |
|--------------------|---------|-------|--------|
| 1                  | 0,1     | 0,3   | 0,5    |
| 2                  | 0,07    | 0,21  | 0,35   |
| 3                  | 0,06    | 0,17  | 0,29   |
| 4                  | 0,05    | 0,15  | 0,25   |
:::

::: {.column width="50%"}
```{r v-de-cramer-pinguins}
effectsize::cramers_v(pinguins$especie,
                      pinguins$ilha,
                      alternative = "two.sided",
                      ci = 0.95)
```
:::

:::
  

## Teste t

* Frequentemente usado para testar hipóteses sobre diferenças entre até duas médias

* Pressupostos:
  - Dados aleatórios e representativos da população
  - Variável dependente contínua
  - Resíduos do modelo são normalmente distribuídos
  
* Exemplos de uso do teste t:
  - Verificar se o peso médio dos bebês da maternidade do HCPA é similar ao
  esperado na população
  - Verificar se as notas do ENEM diferem em estudantes da rede pública e privada
  de ensino
  - Verificar se o uso de uma medicação diminuiu os sintomas ansiosos dos pacientes
  psiquiátricos após um mês
  
## Exemplo de teste t de duas amostras

Vamos supor que queremos verificar se há diferença na massa corporal dos pinguins
machos e fêmeas nos dados `pinguins` do pacote `dados`.

$$
H_0: \mu_{machos} - \mu_{fêmeas} = 0
$$

$$
H_a: \mu_{machos} - \mu_{fêmeas} \ne 0
$$

$$
\alpha = 0,05
$$

```{r histograma-massa-sexo}
#| echo: false
#| out-width: 100%
#| fig-align: "center"
library(dplyr)
pinguins |>
  filter(!is.na(sexo)) |>
  group_by(sexo) |> 
  mutate(sexo = if_else(sexo == "macho", "Macho", "Fêmea"),
         media_massa = mean(massa_corporal)) |>
  ggplot(
    aes(
      x = massa_corporal,
      fill = sexo
    )) +
      geom_histogram(alpha = 0.65) +
      labs(x = "Massa corporal",
           y = "# de pinguins",
           fill = "Sexo") +
      ghibli::scale_fill_ghibli_d("YesterdayMedium", -1) +
      theme_minimal(base_size = 16,
                    base_family = "Charter") +
      geom_vline(aes(xintercept = media_massa, color = sexo), size = 2,
                 show.legend = FALSE) +
      ghibli::scale_colour_ghibli_d("YesterdayMedium", -1)
```


## Teste t no R

```{r teste-t-massa-pinguins}
pinguins |>
  filter(!is.na(sexo)) |>
  group_by(sexo) |>
  summarise(
    media_massa = mean(massa_corporal, na.rm = TRUE),
    dp_massa = sd(massa_corporal, na.rm = TRUE)
  )

t.test(formula = massa_corporal ~ sexo,
       data = pinguins,
       paired = FALSE,
       conf.level = 0.95)
```

## $d$ de Cohen

* O tamanho do efeito pode ser considerado um indicador da
relevância clínica dos grupos

* O $d$ de Cohen é usado para calcular a distância entre as médias das
distribuições sobrepostas

. . .

::: columns
::: {.column width="50%"}
| $d$ de Cohen | Interpretação |
|--------------|-------------|
| $d < 0,2$    | Irrelevante |
| $d \ge 0,2$  |   Pequeno   |
| $d \ge 0,5$  |   Moderado  |
| $d \ge 0,8$  |    Grande   |
:::

::: {.column width="50%"}
```{r d-cohen-pinguins}
effectsize::cohens_d(massa_corporal ~ sexo,
                     data = pinguins,
                     pooled_sd = FALSE,
                     paired = FALSE,
                     ci = 0.95)
```
:::

:::

## ANOVA de uma via

* A ANOVA (análise da variância) representa um conjunto de procedimentos para verificar
diferenças médias entre vários grupos
  - Basicamente um super teste t
  - Também pode ser entendido como um caso especial de um modelo de regressão
  - Uma das análises mais usadas em Psicologia [@chartier_2008]
  
* Pressupostos:
  - Dados aleatórios e representativos da população
  - Variável dependente é contínua
  - Resíduos normalmente distribuídos
  - Resíduos independentes
  - Variância dos resíduos é constante
  
## Exemplo de ANOVA no R

Vamos novamente verificar a diferença na massa corporal, porém agora
entre as ilhas do Arquipélago Palmer.
  
## Referências

::: {#refs}
:::